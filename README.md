–•–æ—Ä–æ—à–æ, –≤–æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–± ‚Äî —Å–Ω–∞—á–∞–ª–∞ –≤—ã–≤–æ–¥–∏–º –ø–æ–ª–æ—Ç–Ω–æ —Å –±–∞–∑–æ–≤—ã–º–∏ —Å—á–µ—Ç–∞–º–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "both" –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –∏—Ö –ø–æ —Å—Ç–∞–≤–∫–µ –∏ –æ–±—ä—ë–º—É:

# –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ–º –±–∞–∑–æ–≤—ã–µ —Å—á–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ç–∏–ø–∞ 'both'
df_both_base = df[(df['CLIENT_TYPE'] == 'both') & (df['IS_PROMO'] == 0)].copy()

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏–∑–∞
df_both_base = df_both_base.sort_values(by=['CLI_ID', 'RATE_BALANCE', 'OUT_RUB'], ascending=[True, True, False])

# –û—Å—Ç–∞–≤–∏–º —Ç–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è
df_both_base = df_both_base[['CLI_ID', 'CON_ID', 'DT_OPEN', 'OUT_RUB', 'RATE_BALANCE']]

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫
print(df_both_base.head(30))


‚∏ª

üîπ –ê–≥—Ä–µ–≥–∏—Ä—É–µ–º –ø–æ —Å—Ç–∞–≤–∫–µ ‚Äî —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ —Å—Ç–∞–≤–∫–∏ –ø–æ—Ä—Ç—è—Ç —Å—Ä–µ–¥–Ω–µ–µ

# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—ä—ë–º–æ–≤ –ø–æ —Å—Ç–∞–≤–∫–∞–º –≤–Ω—É—Ç—Ä–∏ –±–∞–∑–æ–≤—ã—Ö —Å—á–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ BOTH
distribution = (
    df_both_base
    .groupby('RATE_BALANCE')['OUT_RUB']
    .sum()
    .sort_index()
    .reset_index()
)

print(distribution)


‚∏ª

üîπ –ï—Å–ª–∏ —Ö–æ—á–µ—à—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë –≤ Excel:

with pd.ExcelWriter('both_clients_base_accounts.xlsx', engine='openpyxl') as writer:
    df_both_base.to_excel(writer, sheet_name='BaseAccounts', index=False)
    distribution.to_excel(writer, sheet_name='RateDistribution', index=False)


‚∏ª

–≠—Ç–æ—Ç –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∂–µ—Ç:
	‚Ä¢	–ï—Å—Ç—å –ª–∏ –∞–Ω–æ–º–∞–ª—å–Ω–æ –Ω–∏–∑–∫–∏–µ —Å—Ç–∞–≤–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä 1‚Äì3%, —É –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å —Ç–∏–ø–æ–º both.
	‚Ä¢	–ö–∞–∫–æ–π –≤–∫–ª–∞–¥ –≤ –æ–±—â–∏–π –æ–±—ä—ë–º –≤–Ω–æ—Å–∏—Ç –∫–∞–∂–¥–∞—è —Å—Ç–∞–≤–∫–∞.

–•–æ—á–µ—à—å —Ç–∞–∫–∂–µ –≤—ã–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–æ–º–æ-—Å—á–µ—Ç–∞ —ç—Ç–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (IS_PROMO == 1)?
