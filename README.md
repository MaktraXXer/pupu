##############################################################################
# 1.  ФЛАГ «заседание ЦБ ± 3 дня»  (без union_many)                          #
##############################################################################
cb_dates = pd.to_datetime([
    '2024-02-16','2024-03-22','2024-04-26','2024-06-07',
    '2024-07-26','2024-09-13','2024-10-25','2024-12-13',
    '2025-02-07','2025-03-28','2025-04-25','2025-06-06'
])

day_win = 3  # окно ±3 дня

# формируем список диапазонов, склеиваем и убираем дубликаты
ranges = [pd.date_range(d - pd.Timedelta(days=day_win),
                        d + pd.Timedelta(days=day_win)) for d in cb_dates]

cb_window = pd.DatetimeIndex(np.unique(np.concatenate(ranges)))

df['around_cb'] = df.index.isin(cb_window)
