=IF(
  (
    (
      ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
    )^2
    + (
        ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 )/3
      )^3
  )>0;
  /* Δ>0: единственный корень */
  SIGN( -(
          ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
        ) + SQRT(
          (
            ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
          )^2
          + (
              ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 )/3
            )^3
        )
      ) * ABS(
          -(
            ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
          ) + SQRT(
            (
              ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
            )^2
            + (
                ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 )/3
              )^3
          )
        )^(1/3)
  +
  SIGN( -(
          ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
        ) - SQRT(
          (
            ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
          )^2
          + (
              ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 )/3
            )^3
        )
      ) * ABS(
          -(
            ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
          ) - SQRT(
            (
              ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
            )^2
            + (
                ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 )/3
              )^3
          )
        )^(1/3)
  -
  ($B$5/$B$4)/3
;
  IF(
    (
      (
        ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
      )^2
      + (
          ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 )/3
        )^3
    )=0;
    /* Δ=0: два совпадающих корня → берём больший */
    MAX(
      2*SIGN(-(
          ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
        )) * ABS(-(
          ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
        ))^(1/3)
      - ($B$5/$B$4)/3;
      -SIGN(-(
          ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
        )) * ABS(-(
          ( (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4) )/2
        ))^(1/3)
      - ($B$5/$B$4)/3
    );
    /* Δ<0: три действительных → берём максимум */
    MAX(
      2*SQRT( - ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 ) /3 ) * COS( ACOS( -(
            (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4)
          ) / ( 2*SQRT( - ( ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 )/3 )^3 ) ) ) /3 ) - ($B$5/$B$4)/3;
      2*SQRT( - ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 ) /3 ) * COS( ( ACOS( -(
            (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4)
          ) / ( 2*SQRT( - ( ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 )/3 )^3 ) ) ) + 2*PI() ) /3 ) - ($B$5/$B$4)/3;
      2*SQRT( - ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 ) /3 ) * COS( ( ACOS( -(
            (2*($B$5/$B$4)^3)/27 - (($B$5/$B$4)*($B$6/$B$4))/3 + (($B$7-$B$14)/$B$4)
          ) / ( 2*SQRT( - ( ( ($B$6/$B$4) - ($B$5/$B$4)^2/3 )/3 )^3 ) ) ) + 4*PI() ) /3 ) - ($B$5/$B$4)/3
    )
  )
)
